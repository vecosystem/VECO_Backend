<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>OAuth2 Login Test</title>
</head>
<body>
<h1>๐ Google ๋ก๊ทธ์ธ ํ์คํธ</h1>

<div>
    <button id="loginBtn-create-google">Google๋ก ๋ก๊ทธ์ธ - ์ํฌ์คํ์ด์ค ์์ฑ</button>
    <button id="loginBtn-join-google">Google๋ก ๋ก๊ทธ์ธ - ๊ธฐ์กด ์ํฌ์คํ์ด์ค ์ฐธ์ฌ</button>
</div>

<div>
    <button id="loginBtn-create-kakao">kakao๋ก ๋ก๊ทธ์ธ - ์ํฌ์คํ์ด์ค ์์ฑ</button>
    <button id="loginBtn-join-kakao">kakao๋ก ๋ก๊ทธ์ธ - ๊ธฐ์กด ์ํฌ์คํ์ด์ค ์ฐธ์ฌ</button>
</div>

<div>
    <button id="reissue">์ก์ธ์ค ํํฐ ๋ฐ๊ธ</button>
    <!--ํ์คํธ์ฉ ์ก์ธ์ค ํํฐ ์๋ฅ์ฐฝ-->
    <input type="text" id="accessToken" placeholder="์ก์ธ์ค ํํฐ์ ์๋ฅํ์ธ์">
    <button id="logoutBtn">๋ก๊ทธ์์</button>
</div>

<script>
    document.getElementById("loginBtn-create-google").addEventListener("click", () => {
        // ๊ตฌ๊ธ OAuth2 ๋ก๊ทธ์ธ ์์
        window.location.href = "/oauth2/authorization/google?flow=create";
    })

    document.getElementById("loginBtn-join-google").addEventListener("click", () => {
        // ๊ตฌ๊ธ OAuth2 ๋ก๊ทธ์ธ ์์
        window.location.href = "/oauth2/authorization/google?flow=join";
    })

    document.getElementById("loginBtn-create-kakao").addEventListener("click", () => {
        // ์นด์นด์ค OAuth2 ๋ก๊ทธ์ธ ์์
        window.location.href = "/oauth2/authorization/kakao?flow=create";
    })

    document.getElementById("loginBtn-join-kakao").addEventListener("click", () => {
        // ์นด์นด์ค OAuth2 ๋ก๊ทธ์ธ ์์
        window.location.href = "/oauth2/authorization/kakao?flow=join";
    })

    document.getElementById("reissue").addEventListener("click", () => {
        // ์ก์ธ์ค ํํฐ ์ฌ๋ฐ๊ธ ์์ฒญ
        fetch("/api/token/reissue", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            credentials: "include" // ์ฟํค๋ฅผ ํฌํจํ์ฌ ์์ฒญ
        })
            .then(response => {
                if (response.ok) {
                    return response.json();
                } else {
                    throw new Error("ํํฐ ์ฌ๋ฐ๊ธ ์คํจ");
                }
            })
            .then(data => {
                console.log("์๋ก์ด ์ก์ธ์ค ํํฐ:", data.result.accessToken);
                document.getElementById("accessToken").value = data.result.accessToken;
            })
            .catch(error => {
                console.error("์๋ฌ ๋ฐ์:", error);
            });
    })

    document.getElementById("logoutBtn").addEventListener("click", () => {
        // ๋ก๊ทธ์์ ์ฒ๋ฆฌ /api/token/logout์ผ๋ก post ์์ฒญ
        // input์ ์๋ฅ๋ ์ก์ธ์ค ํํฐ์ ์ฌ์ฉํ์ฌ ๋ก๊ทธ์์
        const accessToken = document.getElementById("accessToken").value;
        fetch("/api/token/logout", {
            method: "POST",
            headers: {
                // ํค๋์ ์ก์ธ์ค ํํฐ
                "Content-Type": "application/json",
                "Authorization": "Bearer " + accessToken
            },
            credentials: "include" // ์ฟํค๋ฅผ ํฌํจํ์ฌ ์์ฒญ
        })
    })
</script>
</body>
</html>
